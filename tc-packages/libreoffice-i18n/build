
############################################################################
#                                                                          #
#    package build functions: configure, compile, install, rules, etc.     #
#                                                                          #
############################################################################

build_download() {

   if [ ! -f $_P_SRC/${PACKAGE}-${VERSION}.stamp ]; then
        sudo rm -rf $_P_SRC
        mkdir -p $_P_SRC
        touch $_P_SRC/${PACKAGE}-${VERSION}.stamp
   fi

   cd $_P_SRC
   for lang in $LANG_PACKS
   do
      if [ ! -e LibO_${VERSION}_Linux_x86_helppack-rpm_${lang}.tar.gz ]; then
          wget ${_URL}/LibO_${VERSION}_Linux_x86_helppack-rpm_${lang}.tar.gz || return 1
      fi
      if [ ! -e LibO_${VERSION}_Linux_x86_langpack-rpm_${lang}.tar.gz ]; then
          wget ${_URL}/LibO_${VERSION}_Linux_x86_langpack-rpm_${lang}.tar.gz || return 1
      fi
   done

}

build_unpack() {

   [ -d $P_BIN ] && sudo rm -rf $P_BIN
   mkdir -p $P_BIN

   [ -d $_P_SRC/temp ] && sudo rm -rf $_P_SRC/temp
   mkdir -p $_P_SRC/temp

   for lang in $LANG_PACKS
   do
       sudo mkdir -p $P_BIN/libreoffice-${lang}/usr/local/lib/libreoffice

       cd $_P_SRC/temp
       tar xvf $_P_SRC/LibO_${VERSION}_Linux_x86_langpack-rpm_${lang}.tar.gz || return 1
       cd LibO_${_VERSION}_Linux_x86_langpack-rpm_${lang}/RPMS
       for i in $(ls *.rpm)
       do
          rpm2cpio $i | cpio -idv || return 1
       done
       sudo cp -rf opt/libreoffice/* $P_BIN/libreoffice-${lang}/usr/local/lib/libreoffice

       cd $_P_SRC/temp
       tar xvf $_P_SRC/LibO_${VERSION}_Linux_x86_helppack-rpm_${lang}.tar.gz || return 1
       cd LibO_${_VERSION}_Linux_x86_helppack-rpm_${lang}/RPMS
       for i in $(ls *.rpm)
       do
          rpm2cpio $i | cpio -idv || return 1
       done
       sudo cp -rf opt/libreoffice/* $P_BIN/libreoffice-${lang}/usr/local/lib/libreoffice
   done

}

## rules
build_rules() {

   buildit load || exit 1
   buildit custom download || exit 1
   buildit custom unpack || exit 1
   buildit create || exit 1
   buildit generate || exit 1
   buildit check || exit 1
   buildit package || exit 1

}

